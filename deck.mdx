import { Notes, Head, Appear, themes, Split } from 'mdx-deck'

import { RAppear } from './components/reverse-appear'
import { myTheme } from './theme'
import myFace from './images/my-face2.png'


export const theme = myTheme

<Head>
	<link href="https://pvinis.github.io/iosevka-webfont/2.3.0/webfont.css" rel="stylesheet" />
</Head>


# Upgrading React Native projects

## with Pavlos Vinieratos

#### React Native EU <br /> Wroclaw, Poland

#### 6 September 2019

<Notes>
Thanks to RN EU!
</Notes>

---

<Split>

<img src={myFace} />

I'm `Pavlos`.

`pvinis` on almost everything online.

I work with `Sense Health` making [`NiceDay`](https://niceday.app/).

<Appear>
<div>
I am involved with

- `upgrade-helper`
- `rn-diff-purge`
- `react-native` PRs

I love `upgrading`!
</div>
</Appear>

</Split>

<Notes>
PR with creative names like `Crash Heaven`
</Notes>

---
<!--

I enjoy making things that:

- `work`
- work `well`
- work `simply`

mostly in that order.

---
-->

People love React Native

<RAppear>

## Upgrading

People love `fresh` React Native

</RAppear>

<Notes>
the dreadful part for many

comes every so often

per 2 weeks, 1 month, big feature
</Notes>

---

## Upgrading React Native projects

---

- past: `pain`
- present: `good`
- future: `easy life`

---

## Past: `pain`

---

Question:

`"What do you dislike about React Native?"`

Top voted answer:

`"upgrading requires a lot (too much?) effort"`

<Notes>
570 votes

next was debuggin with 350 votes
</Notes>

---

You need to know all:
- JS/TS
- iOS
- Android

<Notes>
its hard because
</Notes>

---

### iOS

- ObjC/Swift
- complicated `xcodeproj` files and `scheme`s and `config`s
- `carthage`, `cocoapods`, `manual` ways to link libraries
- Xcode

---

### Android

- Java/Kotlin
- `gradle` scripts
- Android Studio

---

### `expo` exists

- it's `awesome`
- it helps people build apps without the need to go native

<Appear>

...until you `need` to go native

</Appear>

<Notes>
need to eject, and back to the hard part
</Notes>

---

### JS/TS

- `babel`, `metro`, `eslint`, `typescript`, ...
- `net-info`, `keep-awake`, `async-storage`, ...

<Notes>
only js easy

native too can go easy

can go very hard
</Notes>

---

upgrading `react` on the web meant:

- change the version number
- yarn install
- see if it works

<Notes>
by running tests or click around
</Notes>

---

upgrading `react native` meant:

- change the version number
- yarn install
- see if it works
- fix native stuff
- see if it works
- fix libraries native stuff
- see if it works
- google things
- see if it works

<Notes>
almost the same
</Notes>

---

"Let's automate this"

- original `react-native upgrade`
- `rnpm upgrade`
- `react-native-git-upgrade`
- `rn-diff` repo

<Notes>
some great people thought:

thats how we got:

suffice it to say there were many iterations.
</Notes>

---

I never liked using any of the `automated` tools ðŸ˜…

I only used `rn-diff`

---

### my flow

- get `notification` for new release
- read the `release notes`
- go to `rn-diff` to see the `diff`, or `generate` it
- go `file-by-file` and make the changes manually

Upgrading `manually` helped me understand `what changed` in my projects

I `almost never` had a problem

<Notes>
when i had a problem it was because there was a difference between my code and the template
</Notes>

---

## Present: `good`

---

- `rn-diff-purge`
- `upgrade-helper`
- `npx react-native upgrade` (`cli`)

---

### rn-diff-purge

- stood on the shoulders of the people and repos before me
- tries to remove all previous problems
- I wanted this for my projects

<Notes>
problems:

- linear upgrading, grid is better, rc
- github diffing cant handle branches

like most open source.. for me to use, happy if anyone else uses it too
</Notes>

---

### rn-diff-purge

- keeps a list of patches `from -> to` every release
- `generated` by a script
- each release gets a branch

<Notes>
https://github.com/react-native-community/rn-diff-purge

show the grid
</Notes>

---

### rn-diff-purge

- based on the project init `template`
- start a new `branch`
- `init` a new project
- `diff` and keep as a patch file

<Notes>
init using the new release

from -> every other release, with the current release

even downgrades

create-react-app
</Notes>

---

### rn-diff-purge

- base of our current upgrade flow
- people already used the idea for `laravel` and `ignite bowser`
- soon a template repo on github, ready to be cloned and reused

<Notes>
links at the end
</Notes>

---

### upgrade-helper

- started as `purge-web`, just pointing to the `diff` file
- allows to chose a `from` and a `to` release
- gives all the changes of the `init template`
- uses `rn-diff-purge`
- steadily becoming `more awesome`

---

### upgrade-helper

- better visuals
- `github-like` diff views
- see `raw` files
- file `folding`
- `links` to release notes
- notes `explaining` changes
- logo and party popper ðŸŽ‰
- support for `rc releases`

<Notes>
https://react-native-community.github.io/upgrade-helper/
</Notes>

---

### npx react-native upgrade (cli)

- just run `npx react-native upgrade`
- uses `rn-diff-purge`

Not perfect, because of differences between the template and each project

<Notes>

each project is unique

cant cover everyone, but we can cover most people, and most rn core related things

it kind of becomes their responsibility to make sure it works after an upgrade

- typescript
- fancy eslint config
- xcconfigs
- tvos

</Notes>

---

<!--

@ncuillery
@lucasbento
@kelset
@cpojer

@watadarkstar iamrestrepo

add laravel and ingite guy

---

#### future: cli, website

try the link-less for android and maybe cocoapods for ios

purge running in CI

---

demo?

real senario
i want to upgrade!
go read the changelog first. learn about what and why of changes (or blog)
i read it, it was cool stuff, i want it!
run `react-native upgrade`
but you said its not ready yet! or it didnt work for me!
true. go to upgrade-helper do it manually
start with config and js stuff, go to ios and android after
yey done!
run your tests, manual test
yeayea let me add hooks.
do it, you have the latest version


final:
changelog
upgrade auto or manual
make sure it not broken
enjoy the new stuff




qna form?

hand-up poll:
- i have done an upgrade
- i prefer manual or i prefer auto


---

# Questions?

- sense
- links to all the others, like bento, mfik or something, etc.
- packt upgrade video?



https://pvin.is




why i like upgrading

give me betas and take my soul


qna form?


make a slide with stuff added in each release, and say that its also a bunch of fixes. Itterally, â€œa bunchâ€




ng the scope of this issue but if you have the desire to answer further I would appreciate the help.
Essentially react-native upgrade was not working for me so I am going the manual route. The first link you have provided for the upgrade guide is what I have been referencing.
However, it's a bit confusing.
Am I supposed to literally update the MODIFIED files by pasting in the changes?
When a file is ADDED how do you know it's proper location in the project?
For ios/Podfile which was added, do to add all of those pods somewhere specific? Or just the text above the message "All these libraries below have been removed from the Xcode project file and now live in the Podfile. Cocoapods handles the linking now. Here you can add more libraries with native modules."? What about all the pods below?
Thanks for your time. Sorry it's just that this upgrade process isn't very clear to me.



future: cli, website
try the link-less for android and maybe cocoapods for ios

demo?

real senario
i want to upgrade!
go read the changelog first. learn about what and why of changes (or blog)
i read it, it was cool stuff, i want it!
run `react-native upgrade`
but you said its not ready yet! or it didnt work for me!
true. go to upgrade-helper do it manually
start with config and js stuff, go to ios and android after
yey done!
run your tests, manual test
yeayea let me add hooks.
do it, you have the latest version


final:
changelog
upgrade auto or manual
make sure it not broken
enjoy the new stuff
 -->


<!--

hand-up poll:
- i have done an upgrade
- i prefer manual or i prefer auto

credits:
- sense
- links to all the others, like bento, mfik or something, etc.
- my blog
- my twitter and gh
- packt upgrade video?
- -->

<!--

https://medium.com/@marcelkalveram/upgrading-react-native-to-version-0-59-and-beyond-a-step-by-step-guide-d4c2926dd482 -->

<!--

'<insert github comments here for upgrading> '
<insert my comment with help how to do it>

link to https://github.com/pvinis/talk-upgrading-react-native/

upload to speakerdeck,
and to my website -->


<!--

- `react-native upgrade`
- open the diff and go through the files
	- first the easy files like package.json, eslintrc, gradle etc
	- trying android
	- https://github.com/react-native-community/cli/blob/master/docs/configuration.md to move rnpm to react-native.config.js
	- trying to make the android with libs without auto, work

links:
https://github.com/guhungry/laravel-diff-purge
https://github.com/nirre7/ignite-bowser-diff-purge



add footer with @pvinis and maaaybe number slides

-->
