import { Notes, Head, Appear, themes, Split } from 'mdx-deck'

import { RAppear } from './components/reverse-appear'
import { myTheme } from './theme'
import myFace from './images/my-face2.png'
import myFace2 from './images/my-face.png'
import howbow from './images/howbow.jpg'
import howbow2 from './images/howbow.webp'


export const theme = myTheme

<Head>
	<link href="https://pvinis.github.io/iosevka-webfont/2.3.0/webfont.css" rel="stylesheet" />
</Head>


# Upgrading React Native projects

## with Pavlos Vinieratos

#### React Native EU <br /> Wroclaw, Poland

#### 6 September 2019

<Notes>
Thanks to RN EU!
</Notes>

---

<Split>

<img src={myFace2} />

I'm `Pavlos`.

`pvinis` on almost everything online.

I work with `Sense Health` making `NiceDay`

<Appear>
<div>
I am involved with

- `upgrade-helper`
- `rn-diff-purge`
- `react-native` PRs

I love `upgrading`!
</div>
</Appear>

</Split>

<Notes>
PR with creative names like `Crash Heaven`
</Notes>

---
<!--

I enjoy making things that:

- `work`
- work `well`
- work `simply`

mostly in that order.

---
-->

People love React Native

<RAppear>

## Upgrading

People love `fresh` React Native

</RAppear>

<Notes>
the dreadful part for many

comes every so often

per 2 weeks, 1 month, big feature
</Notes>

---

## Upgrading React Native projects

<Notes>

show of hands

- done an upgrade?
- painful, ok, so easy?

</Notes>

---

- Past: `pain`
- Present: `pretty good`
- Future: `awesome`

---

## Past: `pain`

---

Question:

`"What do you dislike about React Native?"`

Top voted answer:

`"upgrading requires a lot (too much?) effort"`

<Notes>
570 votes

next was debuggin with 350 votes
</Notes>

---

You need to know all:
- JS/TS
- iOS
- Android

<Notes>
its hard because
</Notes>

---

### iOS

- ObjC/Swift
- Complicated `xcodeproj` files and `scheme`s and `config`s
- Multiple ways to link libraries: `carthage`, `cocoapods`, `manual`
- Xcode

---

### Android

- Java/Kotlin
- `gradle` scripts
- Android Studio

---

### `Expo` exists

- It's `awesome`
- It helps people build apps without the need to go native

<Appear>

...until you `need` to go native

</Appear>

<Notes>
need to eject, and back to the hard part
</Notes>

---

### JS/TS

- `babel`, `metro`, `eslint`, `typescript`, ...
- `netinfo`, `keep-awake`, `async-storage`, ...

<Notes>
only js easy

native too can go easy

can go very hard
</Notes>

---

Upgrading `react` on the web meant:

- `Change the version number`
- yarn install
- `Does it work?` ðŸ˜ƒ

<Notes>
by running tests or click around
</Notes>

---

Upgrading `react native` meant:

- `Change the version number`
- yarn install
- `Does it work?` ðŸ˜ƒ
- Fix native stuff
- `Does it work now?` ðŸ™‚
- Upgrade libraries
- `Does it work yet?` ðŸ¤¨
- Fix libraries native stuff
- `Does it work, please?` ðŸ˜©
- Google things
- `Why don't you work already?` ðŸ˜­

<Notes>
not as easy
</Notes>

---

### "Can't avoid it, let's automate it"

- `react-native upgrade`
- `rnpm upgrade`
- `react-native-git-upgrade`
- `rn-diff` repo

<Notes>
some great people thought:

cant be avoided

thats how we got:

suffice it to say there were many iterations.
</Notes>

---

I never liked using any of the `automated` tools ðŸ˜…

I only used `rn-diff`

---

## Present: `pretty good`

---

- `rn-diff-purge`
- `upgrade-helper`
- `npx react-native upgrade` (`cli`)

---

### rn-diff-purge

- Stood on the shoulders of the people and repos before me
- Tries to remove all previous problems
- I wanted this for my projects

<Notes>
https://github.com/react-native-community/rn-diff-purge/tree/old/master

problems:

- linear upgrading, grid is better, rc
- github diffing cant handle branches

like most open source.. for me to use, happy if anyone else uses it too
</Notes>

---

### rn-diff-purge

- keeps a list of diffs `from -> to` every release
- `generated` by a script
- each release gets a branch

---

### rn-diff-purge

- Based on the project init `template`
- Start a new `branch`
- `init` a new project
- `diff` and keep as a patch file

<Notes>

https://github.com/react-native-community/rn-diff-purge

show the grid

init using the new release

from -> every other release, with the current release

even downgrades

</Notes>

---

### rn-diff-purge

- Base of our current upgrade flow
- People already used the idea for `laravel` and `ignite bowser`
- Soon a template repo on github, ready to be cloned and reused

<Notes>
create-react-app

links at the end
</Notes>

---

### upgrade-helper

- Started as `purge-web`, just pointing to the `diff` file
- Allows to choose a `from` and a `to` release
- Gives all the changes of the `init template`
- Uses `rn-diff-purge`
- Steadily becoming `more awesome`

---

### upgrade-helper

- Better visuals
- `Github-like` diff views
- See `raw` files and `download`
- file `folding`
- `Links` to release notes
- Notes `explaining` changes
- Logo and party popper ðŸŽ‰
- Support for `rc releases`

<Notes>
https://react-native-community.github.io/upgrade-helper/
</Notes>

---

### npx react-native upgrade (cli)

- Just run `npx react-native upgrade`
- Uses `rn-diff-purge`
- Tries to `apply` the diff

It might not work because of differences between the template and each project

<Notes>

each project is unique

cant cover everyone, but we can cover most people, and most rn core related things

it kind of becomes your responsibility to make sure it works after an upgrade

- typescript
- fancy eslint config
- xcconfigs
- tvos

</Notes>

---

## Future: `awesome`

---

- `Autolinking` and standardization of some tools
- `rn-diff-purge` diff generation on CI
- Investigating into tools like `xcodegen`, to decouple and make easier

<Notes>

with help with the upgrading, not so many differences

same as with cocoapods

libraries dont break as much

</Notes>

---

### Tips

- Manual does not mean `slow`, it means `careful`
- Be mindful of `what changed`
- `Pick and choose` your changes
- Try to `stay up to date`
- Try not to `jump` too many versions
- `xcodeproj` needs some care while being changed for now

<Notes>

file by file means we pick and choose. maybe we skip a file, maybe we dont need it.

manual is not slow. its careful

xcode you need to change things in xcode, and see the diff

it will be easier in the future

</Notes>

---

### Upgrade flow

- Get `notification` for new release
- Read the `release notes` and `change log`
- Try `npx react-native upgrade`
- Get diff from `upgrade-helper`
- Go `file-by-file` and make the changes manually
- Start with `config` and `js` stuff, then `iOS`, then `Android` native
- Make sure `any custom additions` and `modules` are compatible and working
- `Test` to make sure things still work
- Use hooks or whatever `cool new feature` is in that new release or rc ðŸ’ª

<Notes>

new release, get excited

https://github.com/facebook/react-native/releases

https://react-native-community.github.io/upgrade-helper/?from=0.59.10&to=0.60.0

npx r-n upgrade, even if its not perfect, report issues

</Notes>

---

### Conclusion

- Upgrading has gotten `better`, `simpler`, more `mature` and it will `keep improving`
- It might always be a `manual` process, or it might be `automatic`
- People used to say `"upgrading is hard"`
- Now people say `"that specific thing was hard while upgrading"`

<Notes>
general complaints

now its specific complaints, matured

we are getting there
</Notes>

---

### Wonderful people so far

@`ncuillery`
@`lucasbento`
@`kelset`
@`cpojer`
@`thymikee`
@`turnrye`
@`grabbou`
@`brentvatne`
@`watadarkstar`
@`iamrestrepo`
@`mausworks`
@`KevinHu2014`
@`vinnyA3`
@`Jeanmsilva89`
@`RubenSandwich`
@`Luckyuke`
@`nirre7`
@`guhungry`
...

- `RN Core` team
- `RN Contributors` community
- `Sense Health`

<Notes>
thanks to these wonderful people for their time and effort

everyone else i forgot

you for helping in the future
</Notes>

---

### Wonderful people of tomorrow

@`your_name_here`

https://github.com/react-native-community, https://github.com/react-native

Look around, contribute:
- Make PRs
- Test out PRs
- Create issues
- Answer issues

---

Don't be afraid of upgrading

Keep the tips in mind

Try the suggested flow

Talk with your team

Talk to us

<Notes>
complain or praise on twitter
</Notes>

---

## Thank you ðŸ’œ

---
<!--

## Thank you ðŸ’œ

- [github.com/react-native-community](https://github.com/react-native-community) (purge, upgrade-helper, cli)
- [niceday.app](https://niceday.app) (app I'm working on)
- [github.com/pvinis/talk-upgrading-react-native](https://github.com/pvinis/talk-upgrading-react-native) (this talk)
- [twitter.com/pvinis](https://twitter.com/pvinis) (my twitter)
- [github.com/pvinis](https://github.com/pvinis) (my github)
- [pvin.is](https://pvin.is) (my blog, ðŸš§)
- [pavlos.dev](https://pavlos.dev) (my portfolio, ðŸš§)
- [youtube.com/watch?v=wBp5_E7dsEY](https://youtube.com/watch?v=wBp5_E7dsEY) (video of me upgrading and explaining)

<Notes>
follow me on twitter or make issues if there are problems or if it worked!
</Notes>

---
-->

<Split>

<img src={myFace} />

## Thank you ðŸ’œ

- [github.com/react-native-community](https://github.com/react-native-community) (purge, upgrade-helper, cli)
- [niceday.app](https://niceday.app) (app I'm working on)
- [github.com/pvinis/talk-upgrading-react-native](https://github.com/pvinis/talk-upgrading-react-native) (this talk)
- [twitter.com/pvinis](https://twitter.com/pvinis) (my twitter)
- [github.com/pvinis](https://github.com/pvinis) (my github)
- [pvin.is](https://pvin.is) (my blog, ðŸš§)
- [pavlos.dev](https://pavlos.dev) (my portfolio, ðŸš§)
- [youtube.com/watch?v=wBp5_E7dsEY](https://youtube.com/watch?v=wBp5_E7dsEY) (video of me upgrading and explaining)

</Split>

<Notes>
follow me on twitter or make issues if there are problems or if it worked!
</Notes>

---
<!--

## For questions:

<img src={howbow2} />

at the coffee break

-->
---

### Extra links

- [github.com/pvinis/template-diff-purge](https://github.com/pvinis/template-diff-purge) (template of the purge way)
- [github.com/guhungry/laravel-diff-purge](https://github.com/guhungry/laravel-diff-purge) (uses the purge way)
- [github.com/nirre7/ignite-bowser-diff-purge](https://github.com/nirre7/ignite-bowser-diff-purge) (uses the purge way)


<!--

-->
